import React from "react";
import { motion } from "framer-motion";

export default function Button({ inputText, setOutputText }) {
  async function handleDiacritization() {
    if (!inputText.trim()) {
      alert("Le texte ne peut pas être vide !");
      return;
    }

    try {
      const response = await fetch("http://127.0.0.1:5000/predict", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ text: inputText }),  
      });

      if (!response.ok) {
        throw new Error(`Erreur serveur : ${response.status} - ${await response.text()}`);
      }

      const data = await response.json();
      setOutputText(data.diacritized_text);

    } catch (error) {
      console.error("Erreur pendant la diacritisation :", error);
    }
  }
   
  return (
    <motion.button 
      onClick={handleDiacritization}
      data-testid="tashkeel-btn"
      className="rounded-full w-16 h-16 bg-[#1f93a6] flex items-center justify-center"
      initial={{ x: -100, opacity: 0 }}      // Position de départ
      animate={{ x: 0, opacity: 1 }}         // Position d'arrivée
      transition={{ duration: 1, ease: "easeOut" }} // Durée et easing
    >
      <svg xmlns="http://www.w3.org/2000/svg" width="46.465" height="27.283" viewBox="0 0 46.465 27.283" className=" flex

          h-full
        w-full items-center justify-center
           "><path fill="#1f93a6" d="M-.9 8.582a6.471 6.471 0 0 1-.652 2.447 6.759 6.759 0 0 1-1.427 1.95 7.111 7.111 0 0 1-2.057 1.288 6.9 6.9 0 0 1-2.533.46 7.043 7.043 0 0 1-2.65-.5A6.734 6.734 0 0 1-12.32 12.8a6.415 6.415 0 0 1-1.4-2.116 7.264 7.264 0 0 1-.5-2.693 7.388 7.388 0 0 1 2.34-5.536l1.4 1.485a3.265 3.265 0 0 0-.417.716 5.416 5.416 0 0 0-.278.834 5.72 5.72 0 0 0-.16.855q-.043.566-.043.769a3.946 3.946 0 0 0 .289 1.528A4.217 4.217 0 0 0-10.3 9.9a3.873 3.873 0 0 0 1.133.834 3.219 3.219 0 0 0 1.336.3A3.19 3.19 0 0 0-5.3 9.993a4.216 4.216 0 0 0 .91-2.875V-4.99L-.9-7.159V4.992h3.36q-.021.684-.021 1.8v1.25a2.626 2.626 0 0 0 .021.545zM4.875-9.467a1.781 1.781 0 0 1-1.517.93.929.929 0 0 1-.909-.563 1.7 1.7 0 0 1-.192-.705 2.8 2.8 0 0 1 .235-.962q.267-.684.566-.684a.189.189 0 0 1 .214.214 3.152 3.152 0 0 1-.128.524 1.5 1.5 0 0 0-.15.577q0 .438.652.438a1.079 1.079 0 0 0 .8-.46q.192-.438.374-.866.3-.652.513-.652.192 0 .192.224l-.043.256-.107.631a.434.434 0 0 0 .417.47.406.406 0 0 0 .427-.256 3.1 3.1 0 0 0 .107-.353.577.577 0 0 0 .107-.235L6.5-11.2q.16-.6.331-.631.235 0 .235.31a3.362 3.362 0 0 1-.066.579l-.085.31-.021.128q-.427 1.539-1.26 1.539a.892.892 0 0 1-.759-.502zM2.364-6.432l4.114-1.6-.214.951L2.043-5.46zM-.479 8.582v-3.59h9.19a1.894 1.894 0 0 0-.588-.962 5.794 5.794 0 0 0-1.25-.83 12.146 12.146 0 0 0-1.613-.656 10.55 10.55 0 0 0-1.71-.353q-1.582-.15-2.212-.15v-2.8A3.665 3.665 0 0 1 1.509-1.9a2.459 2.459 0 0 1 .46-.855 3.586 3.586 0 0 1 .641-.631q.631-.46.695-.5l5.172-3.27a2.737 2.737 0 0 1 1.464-.5 1.411 1.411 0 0 1 1.09.427 1.633 1.633 0 0 1 .4 1.154v2.212a1.363 1.363 0 0 0-.545-.2 1.549 1.549 0 0 0-.524.043 3.1 3.1 0 0 0-.46.182q-.31.171-.438.256L5.1-1.271a9.489 9.489 0 0 1 2.34.748A7.758 7.758 0 0 1 9.374.835a7.679 7.679 0 0 1 1.443 1.859 8.86 8.86 0 0 1 .876 2.3h2.672v3.588zm13.818-19.535l4.125-1.6-.224.972-4.2 1.6zm7.374 4.285l2.426 2.426-2.426 2.426-2.437-2.425zm2.779-3.484l2.4 2.4-2.4 2.437-2.437-2.432zm5.162 5.91l-2.427 2.426-2.437-2.425 2.437-2.426zm-5.409 9.234a19.9 19.9 0 0 0-1.218-2.447l-.1-.182a.959.959 0 0 1-.15-.235.694.694 0 0 0-.128-.224.6.6 0 0 1-.085-.15L24.25-1.4l.417.834a15.7 15.7 0 0 1 1.667 5.557h2.8A19.128 19.128 0 0 0 27.9 2.544l-.085-.182a.959.959 0 0 1-.15-.235.694.694 0 0 0-.128-.224.579.579 0 0 1-.1-.15L30.138-1.4l.417.834A14.169 14.169 0 0 1 32.243 5.7a16.788 16.788 0 0 1-.267 2.885h-20.24V4.992h4.617q-.192-.566-1-2.319L18.02-.149q.566 1.71 1.09 3.591.064.235.438 1.55z" transform="translate(14.222 12.556)"></path></svg>
    </motion.button>
  );
}